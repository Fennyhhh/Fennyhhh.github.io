---
layout:     post
title:      "图像视觉关系理解"
subtitle:   " \"视觉关系理解,遥感\""
date:       2019-12-27 23:56:00
author:     "Fenny"
header-img: "img/post-bg-2015.jpg"
tags:
    - 研究回顾
---

# 视觉关系理解简介
## 主要的视觉理解任务
目标检测：检测出图像中的目标，赋予类别标签并进行定位<br>
语义分割：逐像素分类。只能提供统计性的结果，而不是真正意义上的理解<br>
视觉关系检测：两部分内容：每个视觉单元的意义和他们之间的语义关系。<br>
视觉感知发展迅速，已经十分成熟，而视觉关系理解,如视觉关系检测visual relationship detection (VRD) 和场景图生成scene graph generation(SGG)仍然处于一个比较早期的阶段。<br>
## 为什么要进行视觉关系理解？
视觉关系理解：给计算机一张图片，我们需要算法通过识别关键对象来定位对象的位置以及预测对象之间的关系。<br>
一个基本的视觉任务中有三个要素：类别信息，视觉表示以及他们之间的表示。而视觉关系理解需要用更直接的形式将视觉关系表达出来。<br>
## 视觉感知与视觉关系理解的关系:互补
视觉语义单元是视觉视觉语义关系的前提条件<br>
视觉关系进一步提高视觉单元检测的准确性<br>
## 视觉关系理解意义
在不同语义级别对图像进行的理解（语义单元、区域（实际上是同一级别的不同表现形式）、短语、场景），而这些低中级的视觉任务是更高级语义理解任务的基础（IC/QA）<br>
视觉关系识别是图像理解的基础。可以应用在：<br>
* 物体检测——利用物体间的关系，所处场景来提高物体检测的准确率；
* Image Captioning——图像描述中往往就包含着物体之间的关系的描述，如一个人骑着摩托；
* VQA——视觉问答的一些问题中也是会包含着物体关系的问题，如桌子上面的是什么？；
* Image Retrieval——图像检索任务也会根据自然语言描述或者图像来检索相关的图像；
* Image Generation——根据自然语言来生成图像的任务中需要理解自然语言中的物体，以及物体之间的关系，才能更好的生成符合描述的图像

## 视觉关系理解统一范式
给定一幅图像I，视觉感知模块利用CNN（如RPN网络），获得一系列的边界框BI
视觉关系推理需要推理以下三个变量：
* 相关的目标类别标签
* 边界框相应的四个偏移量
* 潜在目标对之间的谓词标签（关系）
## 视觉关系理解模型的训练
1. 模块化训练，模型误差只在视觉上下文推理模块中反向传播。
2. end-to-end训练，进一步将误差反向传播到先前的视觉感知模块。
* 1）性能容易提升
* 2）通过简单的张量操作可以完成消息传递等经典推理操作
* 3）充分利用GPU的并行计算能力，提高训练速度

# 视觉关系理解主要发展
## 基于语言先验的视觉关系检测
### 背景
1. 视觉语义关系遵循长尾分布，它们通常在语义上彼此相关，这意味着可以从类似关系推断出不频繁的关系。为了充分利用可用的图像训练数据，可以使用它们的语义属性作为外部先验知识来规范化目标优化问题。
2. 将外部语言先验知识提炼到相关的学习系统中，可以相应地进一步规范目标约束优化问题的目标函数。外部语言知识不仅可以提高推理速度，还可以解决零次学习的任务。
### 方法
1. 内部先验知识
从视觉刺激本身获得的，例如：通过计算训练集中标注信息的条件概率P来获得语言知识。<br>
相关研究：<br>
* Tensorize, Factorize and Regularize: Robust Visual Relationship Learning, Seong Jae Hwang, et.al., CVPR 2018。使用因式分解的方法来得到信息先验，即两个对象间的谓语分布。
2. 外部先验知识
从外部来源获得的，例如：从外部知识库（如word2vec、维基百科等）来获得语言知识。<br>
相关研究：<br>
* Visual Relationship Detection with Language Priors, Cewu Lu, et.al, ECCV 2016.利用在其他大型语义库上训练好的Word2vec将对象转换成一个词向量，将词向量连接，最后计算得到语义层面的关系概率<br>
### 总结
*优点：*
1. 结合概率语义先验有助于分类器的预测不是很确定的情况，以及对训练集中未观察到的三元组的推广。
2. 利用内部和外部语言知识规范神经网络，能增强其预测能力。
*不足：*
1. 内部先验知识仅能捕获一小部分所需的知识，不能达到明显提高模型效果的目的。
2. 外部先验知识虽然涵盖范围更广，知识更加通用，但是非常嘈杂，包含很多优于提取过程中的语言分析错误造成的噪声。

## 视觉关系理解模型的发展
### 模型的发展——联合检测目标及关系
基于目标区域检测的特征联合检验目标和关系，将目标和关系视为一个整体来同时检测目标对三元组的短语，复杂度N*R*N。

### 模型的发展——先检测目标再检测关系
使用目标特征识别目标、短语特征识别关系。与其说是先后关系，不如说是并列关系。复杂度N+R
### 消息传递机制
基本的预测关系的方法独立地预测每两个对象间的关系（local），而忽略了场景中的其他对象，关系，即周围上下文的信息对预测关系的相互帮助作用。消息传递机制分为：
1. 目标物、参照物、关系之间的消息传递
2. 层级视觉关系理解中的消息传递
3. 基于MRF或者CRF视觉关系理解的消息传递

## 基于迁移学习的视觉关系检测
### 背景
* why:视觉关系注释数据的稀缺性
* what:如何处理场景图中视觉关系的大变异性？/如何有效利用未标记的目标数据？
* how:迁移学习/弱监督/半监督学习
### 迁移学习
* 目标：将某个领域或任务上学习到的知识或模式应用到不同但相关的领域或问题中
* 主要思想：从相关领域中迁移标注数据或者知识结构、完成或改进目标领域或任务的学习效果
* 域：可以理解为某个时刻的某个特定领域，比如书本评论和电视剧评论可以看作是两个不同的domain
* 任务：要做的事情，比如情感分析和实体识别就是两个不同的task
### 视觉关系迁移学习
1. 主要以基于特征的迁移为主：<br>
**特征选择**
如何找出源领域与目标领域之间共同的特征表示(视觉概念），然后利用这些特征进行知识迁移<br>
**特征映射**
如何将源领域和目标领域的视觉关系特征从原始特征空间映射到新的特征空间中去<br>
2. 解决问题：
研究可以用哪些知识在不同的领域或者任务中进行迁移学习，即不同领域之间有哪些共有知识可以迁移。<br>
研究在找到了迁移对象之后，针对具体问题所采用哪种迁移学习的特定算法，即如何设计出合适的算法来提取和迁移共有知识。<br>
研究什么情况下适合迁移，迁移技巧是否适合具体应用，其中涉及到负迁移的问题<br>
## 弱/半监督视觉关系检测
### 背景
缺乏注释，但上传到网站的图片通常包含噪声tag，其中有很多信息可用来描述场景和对象<br>
注释可用的数据量极少<br>
### 主要方法
发现常识关系并标记给定视觉类别实例<br>
收集关键词，结构化查询一个概念的不同实例<br>
利用未标记的目标域实例的平均差异估计源域和目标域之间的数据分布差异<br>
利用弱注释信息对物体和属性进行定位<br>


# 遥感影像视觉关系理解
## 背景
1. 理解什么关系？<br>
空间关系？属性？功能？...<br>
2. 如何为视觉关系建模？<br>
 遥感影像的特点：场景大、目标多、目标边界框重叠率很高<br>
3. 如何根据给定的信息推断后验分布？<br>
